<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>

<canvas id="ctx" width="1000" height="500" style="border: solid; "></canvas>
<script>




    var imageObject= function (x,y,dx,dy) {
        this.x=x;
        this.y=y;
        this.dy=dy;
        this.dx=dx;
    }
    var movementImage= function (ListImages) {
        var self={
            listOfImages:ListImages
        };
        var i=0;
        self.getLenghtOfListImages=function () {
            var n=0;
            for(var j in self.listOfImages)
                n++;
            return n;
        }
        self.getImage=function () {
            var imagen;
            if(i<self.getLenghtOfListImages()) {
                imagen=ListImages[i];
                i++;
            }
            else {
                i = 0;
                imagen=ListImages[i];
                i++;
            }
            return imagen;

        }
        self.drawImage=function () {

        }
        return self;
    }
    function ImageCoordinate(x,y,w,h){
        this.x=x;
        this.y=y;
        this.dw=w;
        this.dh=h;
    }

    var Player=function()
    {
        this.width=17;
        this.heigh=43;
        this.rw=17/2;
        this.rh=43/2;
        this.x=250;
        this.y=250;
        this.moveDown=false;
        this.moveUp=false;
        this.moveLeft=false;
        this.moveRight=false;
        this.listMovementObjects=new Array();
        this.currentImage=new ImageCoordinate(65+(17+6),65,17,43);
    }
    Player.moveDownIndex=0;
    Player.moveUpIndex=1;
    Player.moveLeftIndex=2;
    Player.moveRightIndex=3;
    //Player.currentImage;
    Player.prototype.pushImageMovement=function (movementIndex, imageCoordinate) {
        this.listMovementObjects[movementIndex]=imageCoordinate;
    }
    Player.prototype.resetMovement=function () {
        this.moveDown=false;
        this.moveUp=false;
        this.moveLeft=false;
        this.moveRight=false;

    }
    Player.prototype.update=function (ctx, img) {
        if(this.moveDown)
        {
            var tempA=this.listMovementObjects[Player.moveDownIndex].getImage();
            this.currentImage=tempA;
            ctx.drawImage(img, tempA.x, tempA.y,tempA.dw,tempA.dh, this.x-this.rw,this.y-this.rh,17,43);
        }
        if(this.moveUp)
        {
            var tempA=this.listMovementObjects[Player.moveUpIndex].getImage();
            this.currentImage=tempA;
            ctx.drawImage(img, tempA.x, tempA.y,tempA.dw,tempA.dh, this.x-this.rw,this.y-this.rh,17,43);
        }
        if(this.moveRight)
        {
            var tempA=this.listMovementObjects[Player.moveRightIndex].getImage();
            this.currentImage=tempA;
            ctx.drawImage(img, tempA.x, tempA.y,tempA.dw,tempA.dh, this.x-this.rw,this.y-this.rh,17,43);
        }
        if(this.moveLeft)
        {
            var tempA=this.listMovementObjects[Player.moveLeftIndex].getImage();
            this.currentImage=tempA;
            ctx.drawImage(img, tempA.x, tempA.y,tempA.dw,tempA.dh, this.x-this.rw,this.y-this.rh,17,43);
        }
        else {
            //var tempA=this.listMovementObjects[0].getImage();
            //this.currentImage=tempA;
            ctx.drawImage(img, this.currentImage.x, this.currentImage.y, this.currentImage.dw, this.currentImage.dh, this.x - this.rw, this.y - this.rh, 17, 43);
        }
        this.resetMovement()
        //Player.resetMovement();
    }

    var player= new Player();
    var downMovement=[];
    var upMovement=[];
    var lefthMovement=[];
    var rightMovement=[];

    downMovement[0]=new ImageCoordinate(65,65,17,43);
    downMovement[1]=new ImageCoordinate(88,65,17,43);
    downMovement[2]=new ImageCoordinate(110,65,17,43);
    downMovement[3]=new ImageCoordinate(131,65,17,43);
    downMovement[4]=new ImageCoordinate(151,65,17,43);
    downMovement[5]=new ImageCoordinate(173,65,17,43);
    downMovement[6]=new ImageCoordinate(196,65,17,43);
    downMovement[7]=new ImageCoordinate(216,65,17,43);
    downMovement[8]=new ImageCoordinate(237,65,17,43);

    upMovement[0]= new ImageCoordinate(66,113,17,43);
    upMovement[1]= new ImageCoordinate(88,113,17,43);
    upMovement[2]= new ImageCoordinate(110,113,17,43);
    upMovement[3]= new ImageCoordinate(130,113,17,43);
    upMovement[4]= new ImageCoordinate(151,113,17,43);
    upMovement[5]= new ImageCoordinate(173,113,17,43);
    upMovement[6]= new ImageCoordinate(192,113,17,43);
    upMovement[7]= new ImageCoordinate(211,113,17,43);
    upMovement[8]= new ImageCoordinate(231,113,17,43);

    player.listMovementObjects.push(new movementImage(downMovement));
    player.listMovementObjects.push(new movementImage(upMovement));

    var gameImages={};
    gameImages.Player= new Image();
    gameImages.Player.onload= function () {

        ctx.drawImage(gameImages.Player, 65, 65,17,43, player.x-player.rw,player.x-player.rh,17,43);
    }
    gameImages.Player.src='client/img/hpcharacter.png';
    var canvas = document.getElementById("ctx");
    var ctx = canvas.getContext("2d");


    setInterval(function () {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.beginPath();
        ctx.fillRect(20,20,10,10);
        ctx.arc(player.x,player.y,player.rw,0,Math.PI*2,true);
        ctx.stroke();
        ctx.rect(player.x-player.rw,player.y-player.rh,player.width,player.heigh);
        ctx.stroke();

        player.update(ctx,gameImages.Player);
        //ctx.drawImage(gameImages.Player, 65, 65,17,43, player.x-player.rw,player.y-player.rh,17,43);
    },1000/15);

    //var image = document.getElementById('source');

    //void ctx.drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight);



    document.onkeydown= function (event) {
        //console.log(event.keyCode);
        switch (event.keyCode)
        {
            case 38:{
                console.log('Arriba!!');
                player.y--;
                player.moveUp=true
                break;
            }
            case 40:{
                console.log('Abajo !!');
                player.y++;
                player.moveDown=true;
                break;
            }
            case 39:{
                console.log('Derecha !!');
                player.x++;
                player.moveRight=true;
                break;
            }
            case 37:{
                console.log('Izquierda !!');
                player.x--;
                player.moveLeft=true;
                break;
            }
        }
    }

</script>


</html>